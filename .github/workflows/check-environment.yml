name: Test and Check The Environment
on:
  workflow_dispatch:

jobs:
  check-environment:
    runs-on: macos-13
    steps:
      - name: Cache SDKMAN
        uses: actions/cache@v4
        with:
          path: ~/.sdkman
          key: sdkman-${{ runner.os }}-${{ runner.arch }}-graal25ea28-maven4rc4

      - name: Set up GraalVM JDK
        run: |
          if [ ! -f "$HOME/.sdkman/bin/sdkman-init.sh" ]; then
            curl -s "https://get.sdkman.io" | bash
          fi

          source "$HOME/.sdkman/bin/sdkman-init.sh"

          # Install only if not already cached
          if [ ! -d "$HOME/.sdkman/candidates/java/25.ea.28-graal" ]; then
            sdk install java 25.ea.28-graal
          fi

          if [ ! -d "$HOME/.sdkman/candidates/maven/4.0.0-rc-4" ]; then
            sdk install maven 4.0.0-rc-4
          fi

          sdk use java 25.ea.28-graal
          sdk use maven 4.0.0-rc-4

      - name: Get Information
        run: |
          source "$HOME/.sdkman/bin/sdkman-init.sh"
          java --version
          mvn --version

      - name: Update Formula File
        run: |
          ls -la
          ls -la tools/
          java -jar tools/GenBrewRuby.jar --NewVersion 1.11.11 --ARMSHA 22b3a8d4fdb0af6c377fe1c76017aac14c9d0672e8123fcdf67dea690a1f7214 --x86SHA 765016159902f24894a8b4151fcd8dd00c746584a41fd6fa105c6023ce6ba9b2
          cat snapzap.rb
          
